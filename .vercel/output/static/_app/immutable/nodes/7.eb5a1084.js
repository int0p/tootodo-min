import{f as T}from"../chunks/fetch-refresh.dd216df5.js";import{e as D}from"../chunks/index.5e2a9a64.js";import{S as B,i as H,s as U,e as v,t as X,d as N,f as k,g as P,k as G,l as g,j,m as A,p as w,r as b,A as K,z as u,w as h,y as I,J,v as L,X as Q,b as F,h as q,q as V,x as M}from"../chunks/index.9f73b2d7.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.b57464ad.js";import"../chunks/Modal.svelte_svelte_type_style_lang.7c9bde1f.js";import"../chunks/moment.a354566a.js";import"../chunks/chunk-5UWJICAP.5753fd06.js";import"../chunks/paths.cfd798f3.js";import{C as W}from"../chunks/Card.423691da.js";import{t as Y}from"../chunks/toasts.61af73bb.js";import{P as Z}from"../chunks/Pagination.cc9bb438.js";const x=async({params:p,fetch:e,url:n,depends:a,route:c})=>{const i=_=>T(e,_);a(`app:${c.id}`);const{list:s,rest:r}=p,f=18,t=n.searchParams.get("page"),l=new URLSearchParams({limit:`${f}`,offset:t?`${f*(Number(t)-1)}`:"0"}).toString();let o,m;if(s==="section"&&r==="new-releases")o=i(`/spotify/api/spotify/browse/new-releases?${l}`),m="New Releases";else if(s==="section"&&r==="featured-playlists")o=i(`/spotify/api/spotify/browse/featured-playlists?${l}`),m="Featured Playlists";else if(s==="category"){o=i(`/spotify/api/spotify/browse/categories/${r}/playlists?${l}`);const _=await i(`/spotify/api/spotify/browse/categories/${r}`),y=_.ok?await _.json():void 0;m=y?`${y.name} Playlists`:"Playlists"}else if(s==="profile"&&r==="following")o=await i(`/spotify/api/spotify/me/following?type=artist&${l}`),m="Following";else if(s==="artist"){const _=r.split("/")[0],y=r.split("/")[1];if(!_||!["albums","appears-on","related-artists"].includes(y))throw D(404,{message:"Page not found!"});const O=await i(`/spotify/api/spotify/artists/${_}`),$=O.ok?await O.json():void 0;y==="albums"&&(o=i(`/spotify/api/spotify/artists/${_}/albums?include_groups=album,single&${l}`),m=$?`${$.name} Albums`:"Albums"),y==="appears-on"&&(o=i(`/spotify/api/spotify/artists/${_}/albums?include_groups=appears_on&${l}`),m=$?`${$.name} Appearances`:"Appearances"),y==="related-artists"&&(o=i(`/spotify/api/spotify/artists/${_}/related-artists`),m=$?`Related to ${$.name}`:"Related Artists")}if(!o)throw D(404,"Page Not Found!");const S=await o;if(!S.ok)throw D(S.status,"Failed to Load Data!");const d=await S.json();return{data:(()=>{if("items"in d)return d;if("playlists"in d)return d.playlists;if("albums"in d)return d.albums;if("artists"in d)return"items"in d.artists?d.artists:{items:d.artists}})(),title:m}},dt=Object.freeze(Object.defineProperty({__proto__:null,load:x},Symbol.toStringTag,{value:"Module"}));function R(p,e,n){const a=p.slice();return a[4]=e[n],a}function z(p){let e,n,a,c,i=p[2].items,s=[];for(let t=0;t<i.length;t+=1)s[t]=C(R(p,i,t));const r=t=>h(s[t],1,1,()=>{s[t]=null});let f="next"in p[2]&&E(p);return{c(){e=v("div");for(let t=0;t<s.length;t+=1)s[t].c();n=N(),f&&f.c(),a=J(),this.h()},l(t){e=k(t,"DIV",{class:!0});var l=P(e);for(let o=0;o<s.length;o+=1)s[o].l(l);l.forEach(g),n=j(t),f&&f.l(t),a=J(),this.h()},h(){A(e,"class","grid-items svelte-zggvko")},m(t,l){w(t,e,l);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);w(t,n,l),f&&f.m(t,l),w(t,a,l),c=!0},p(t,l){if(l&4){i=t[2].items;let o;for(o=0;o<i.length;o+=1){const m=R(t,i,o);s[o]?(s[o].p(m,l),u(s[o],1)):(s[o]=C(m),s[o].c(),u(s[o],1),s[o].m(e,null))}for(L(),o=i.length;o<s.length;o+=1)r(o);I()}"next"in t[2]?f?(f.p(t,l),l&4&&u(f,1)):(f=E(t),f.c(),u(f,1),f.m(a.parentNode,a)):f&&(L(),h(f,1,1,()=>{f=null}),I())},i(t){if(!c){for(let l=0;l<i.length;l+=1)u(s[l]);u(f),c=!0}},o(t){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)h(s[l]);h(f),c=!1},d(t){t&&g(e),Q(s,t),t&&g(n),f&&f.d(t),t&&g(a)}}}function C(p){let e,n,a,c;return n=new W({props:{item:p[4]}}),{c(){e=v("div"),F(n.$$.fragment),a=N(),this.h()},l(i){e=k(i,"DIV",{class:!0});var s=P(e);q(n.$$.fragment,s),a=j(s),s.forEach(g),this.h()},h(){A(e,"class","grid-item")},m(i,s){w(i,e,s),V(n,e,null),b(e,a),c=!0},p(i,s){const r={};s&4&&(r.item=i[4]),n.$set(r)},i(i){c||(u(n.$$.fragment,i),c=!0)},o(i){h(n.$$.fragment,i),c=!1},d(i){i&&g(e),M(n)}}}function E(p){let e,n;return e=new Z({props:{paginatedList:p[2],isLoading:p[1]}}),e.$on("loadmore",p[3]),{c(){F(e.$$.fragment)},l(a){q(e.$$.fragment,a)},m(a,c){V(e,a,c),n=!0},p(a,c){const i={};c&4&&(i.paginatedList=a[2]),c&2&&(i.isLoading=a[1]),e.$set(i)},i(a){n||(u(e.$$.fragment,a),n=!0)},o(a){h(e.$$.fragment,a),n=!1},d(a){M(e,a)}}}function tt(p){var f;let e,n,a=p[0].title+"",c,i,s,r=((f=p[2])==null?void 0:f.items)&&z(p);return{c(){e=v("div"),n=v("h1"),c=X(a),i=N(),r&&r.c(),this.h()},l(t){e=k(t,"DIV",{class:!0});var l=P(e);n=k(l,"H1",{});var o=P(n);c=G(o,a),o.forEach(g),i=j(l),r&&r.l(l),l.forEach(g),this.h()},h(){A(e,"class","content svelte-zggvko")},m(t,l){w(t,e,l),b(e,n),b(n,c),b(e,i),r&&r.m(e,null),s=!0},p(t,[l]){var o;(!s||l&1)&&a!==(a=t[0].title+"")&&K(c,a),(o=t[2])!=null&&o.items?r?(r.p(t,l),l&4&&u(r,1)):(r=z(t),r.c(),u(r,1),r.m(e,null)):r&&(L(),h(r,1,1,()=>{r=null}),I())},i(t){s||(u(r),s=!0)},o(t){h(r),s=!1},d(t){t&&g(e),r&&r.d()}}}function et(p,e,n){let a,{data:c}=e,i=!1;const s=async()=>{if(a&&"next"in a&&a.next){n(1,i=!0);const r=await fetch(a.next.replace("https://api.spotify.com/v1/","/spotify/api/spotify/"));if(r.ok){const f=await r.json(),t=f.albums||f.playlists||f.artists||f;n(2,a={...t,items:[...a.items,...t.items]})}else Y.error("Could not load data!");n(1,i=!1)}};return p.$$set=r=>{"data"in r&&n(0,c=r.data)},p.$$.update=()=>{p.$$.dirty&1&&n(2,a=c.data)},[c,i,a,s]}class _t extends B{constructor(e){super(),H(this,e,et,tt,U,{data:0})}}export{_t as component,dt as universal};
