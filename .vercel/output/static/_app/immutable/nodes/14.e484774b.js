import{f as F}from"../chunks/fetch-refresh.dd216df5.js";import{e as H}from"../chunks/index.5e2a9a64.js";import{S as T,i as U,s as X,e as k,d as L,b as D,f as P,g as N,l as $,j,h as I,m as O,p as w,q as A,w as v,y as R,z as g,x as E,v as Y,t as C,k as M,r as S,A as G,X as K}from"../chunks/index.62fc0439.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.fe36e70c.js";import"../chunks/Modal.svelte_svelte_type_style_lang.10e906d4.js";import"../chunks/moment.a354566a.js";import"../chunks/paths.079c38ab.js";import{B as q}from"../chunks/Button.78294429.js";import{C as Q}from"../chunks/Card.6439f086.js";import{t as W}from"../chunks/toasts.ae3a6e2f.js";import{P as Z}from"../chunks/Pagination.fd2b1820.js";import{P as x}from"../chunks/PlaylistForm.ef96aaa6.js";import{M as tt}from"../chunks/Modal.de47eda4.js";import{l as et}from"../chunks/micromodal.es.946cf5e2.js";const st=async({fetch:n,url:t})=>{const s=t.searchParams.get("page"),a=new URLSearchParams({limit:"18",offset:s?`${18*(Number(s)-1)}`:"0"}).toString(),r=await F(n,`/spotify/api/spotify/me/playlists?${a}`);if(!r.ok)throw H(r.status,"Failed to load playlists!");return{userPlaylists:await r.json(),title:"Your Playlists"}},Pt=Object.freeze(Object.defineProperty({__proto__:null,load:st},Symbol.toStringTag,{value:"Module"}));function B(n,t,e){const s=n.slice();return s[6]=t[e],s}function lt(n){let t,e,s,a,r,f;return r=new q({props:{element:"a",href:"./playlists/new",$$slots:{default:[rt]},$$scope:{ctx:n}}}),{c(){t=k("div"),e=k("p"),s=C("No Playlists Yet!"),a=L(),D(r.$$.fragment),this.h()},l(u){t=P(u,"DIV",{class:!0});var i=N(t);e=P(i,"P",{class:!0});var p=N(e);s=M(p,"No Playlists Yet!"),p.forEach($),a=j(i),I(r.$$.fragment,i),i.forEach($),this.h()},h(){O(e,"class","svelte-ap3in5"),O(t,"class","empty svelte-ap3in5")},m(u,i){w(u,t,i),S(t,e),S(e,s),S(t,a),A(r,t,null),f=!0},p(u,i){const p={};i&512&&(p.$$scope={dirty:i,ctx:u}),r.$set(p)},i(u){f||(g(r.$$.fragment,u),f=!0)},o(u){v(r.$$.fragment,u),f=!1},d(u){u&&$(t),E(r)}}}function at(n){let t,e,s=n[0].title+"",a,r,f,u,i,p,o,d;f=new q({props:{element:"a",href:"/playlists/new",$$slots:{default:[ot]},$$scope:{ctx:n}}}),f.$on("click",n[5]);let h=n[3].items,c=[];for(let l=0;l<h.length;l+=1)c[l]=J(B(n,h,l));const z=l=>v(c[l],1,1,()=>{c[l]=null});return o=new Z({props:{paginatedList:n[3],isLoading:n[2]}}),o.$on("loadmore",n[4]),{c(){t=k("div"),e=k("h2"),a=C(s),r=L(),D(f.$$.fragment),u=L(),i=k("div");for(let l=0;l<c.length;l+=1)c[l].c();p=L(),D(o.$$.fragment),this.h()},l(l){t=P(l,"DIV",{class:!0});var m=N(t);e=P(m,"H2",{});var y=N(e);a=M(y,s),y.forEach($),r=j(m),I(f.$$.fragment,m),m.forEach($),u=j(l),i=P(l,"DIV",{class:!0});var b=N(i);for(let _=0;_<c.length;_+=1)c[_].l(b);b.forEach($),p=j(l),I(o.$$.fragment,l),this.h()},h(){O(t,"class","title relative -top-2.5 svelte-ap3in5"),O(i,"class","grid-items svelte-ap3in5")},m(l,m){w(l,t,m),S(t,e),S(e,a),S(t,r),A(f,t,null),w(l,u,m),w(l,i,m);for(let y=0;y<c.length;y+=1)c[y]&&c[y].m(i,null);w(l,p,m),A(o,l,m),d=!0},p(l,m){(!d||m&1)&&s!==(s=l[0].title+"")&&G(a,s);const y={};if(m&512&&(y.$$scope={dirty:m,ctx:l}),f.$set(y),m&8){h=l[3].items;let _;for(_=0;_<h.length;_+=1){const V=B(l,h,_);c[_]?(c[_].p(V,m),g(c[_],1)):(c[_]=J(V),c[_].c(),g(c[_],1),c[_].m(i,null))}for(Y(),_=h.length;_<c.length;_+=1)z(_);R()}const b={};m&8&&(b.paginatedList=l[3]),m&4&&(b.isLoading=l[2]),o.$set(b)},i(l){if(!d){g(f.$$.fragment,l);for(let m=0;m<h.length;m+=1)g(c[m]);g(o.$$.fragment,l),d=!0}},o(l){v(f.$$.fragment,l),c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)v(c[m]);v(o.$$.fragment,l),d=!1},d(l){l&&$(t),E(f),l&&$(u),l&&$(i),K(c,l),l&&$(p),E(o,l)}}}function rt(n){let t;return{c(){t=C("+ Add New")},l(e){t=M(e,"+ Add New")},m(e,s){w(e,t,s)},d(e){e&&$(t)}}}function ot(n){let t;return{c(){t=C("+ Add New")},l(e){t=M(e,"+ Add New")},m(e,s){w(e,t,s)},d(e){e&&$(t)}}}function J(n){let t,e;return t=new Q({props:{item:n[6]}}),{c(){D(t.$$.fragment)},l(s){I(t.$$.fragment,s)},m(s,a){A(t,s,a),e=!0},p(s,a){const r={};a&8&&(r.item=s[6]),t.$set(r)},i(s){e||(g(t.$$.fragment,s),e=!0)},o(s){v(t.$$.fragment,s),e=!1},d(s){E(t,s)}}}function nt(n){var s;let t,e;return t=new x({props:{form:n[1],userID:(s=n[0].user)==null?void 0:s.id,action:"/spotify/playlists/new"}}),{c(){D(t.$$.fragment)},l(a){I(t.$$.fragment,a)},m(a,r){A(t,a,r),e=!0},p(a,r){var u;const f={};r&2&&(f.form=a[1]),r&1&&(f.userID=(u=a[0].user)==null?void 0:u.id),t.$set(f)},i(a){e||(g(t.$$.fragment,a),e=!0)},o(a){v(t.$$.fragment,a),e=!1},d(a){E(t,a)}}}function it(n){let t,e,s,a,r,f;const u=[at,lt],i=[];function p(o,d){return o[3].items.length>0?0:1}return e=p(n),s=i[e]=u[e](n),r=new tt({props:{id:"add-playlist-modal",title:"Add a New Playlist",$$slots:{default:[nt]},$$scope:{ctx:n}}}),{c(){t=k("div"),s.c(),a=L(),D(r.$$.fragment),this.h()},l(o){t=P(o,"DIV",{class:!0});var d=N(t);s.l(d),d.forEach($),a=j(o),I(r.$$.fragment,o),this.h()},h(){O(t,"class","content svelte-ap3in5")},m(o,d){w(o,t,d),i[e].m(t,null),w(o,a,d),A(r,o,d),f=!0},p(o,[d]){let h=e;e=p(o),e===h?i[e].p(o,d):(Y(),v(i[h],1,1,()=>{i[h]=null}),R(),s=i[e],s?s.p(o,d):(s=i[e]=u[e](o),s.c()),g(s,1),s.m(t,null));const c={};d&515&&(c.$$scope={dirty:d,ctx:o}),r.$set(c)},i(o){f||(g(s),g(r.$$.fragment,o),f=!0)},o(o){v(s),v(r.$$.fragment,o),f=!1},d(o){o&&$(t),i[e].d(),o&&$(a),E(r,o)}}}function ft(n,t,e){let s,{data:a}=t,{form:r}=t,f=!1;async function u(){if(!s.next)return;e(2,f=!0);const p=await fetch(s.next.replace("https://api.spotify.com/v1/","/spotify/api/spotify/"));if(p.ok){const o=await p.json();e(3,s={...o,items:[...s.items,...o.items]})}else W.error("Could not load data!");e(2,f=!1)}const i=p=>{p.preventDefault(),et.show("add-playlist-modal")};return n.$$set=p=>{"data"in p&&e(0,a=p.data),"form"in p&&e(1,r=p.form)},n.$$.update=()=>{n.$$.dirty&1&&e(3,s=a.userPlaylists)},[a,r,f,s,u,i]}class Nt extends T{constructor(t){super(),U(this,t,ft,it,X,{data:0,form:1})}}export{Nt as component,Pt as universal};
